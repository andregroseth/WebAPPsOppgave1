@model List<WebAppsProsjekt1.Models.Movie>

@{
    ViewBag.Title = "MovieList";
    Layout = "~/Views/Shared/Background.cshtml";
}
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link href="~/Content/css/cssMovie/cssMovieList.css" rel="stylesheet" />
    <script type="text/javascript">
        $(document).ready(function () {
            // Hendelse som utføres når en a-href med "data-movieDetailsModal = true" trykkes
            $('a[data-movieDetailsModal=true]').click(function () {

                // Hente inn data-taggene fra a-href link, bugged as shit
                var data_title = $(this).data('title');
                var data_cost = $(this).data('cost');
                var data_image = $(this).data('image');
                var data_id = $(this).data('id');

                // Legge data inn i div'en i modal-viewet
                $('#movieTitle').html(data_title);
                $('#movieImage').attr("src", data_image);
                $('#movieCost').html(data_cost);
                $('#movieId').html(data_id);

                // Legge film til shopping cart
                $("#addToCartBtn").click(function () {
                    $.ajax({
                        url: '@Url.Action("AddMovieToCart", "Movie")',
                        data: { id: document.getElementById("movieId").innerHTML },
                        success: function () {
                        },
                        error: function () {
                            alert("Feil");
                        }
                    });
                })
            })
        });
    </script>
</head>

<body>
    <div>
        <h2>Movies</h2>
        <div class="row">
            <div class="row__inner">
                @foreach (var movie in Model)
                {
                    if (movie.ImagePath == null)
                    {
                    }
                    else
                    {
                        // Render film-objektene og displayer dem i viewet
                        @Html.Partial("MovieListPartial", movie)
                    }
                }
            </div>
        </div>

        @*Pop-up modalen som viser når man velger en film*@
        @Html.Partial("movieDetailsModal")
    </div>
</body>
</html>
